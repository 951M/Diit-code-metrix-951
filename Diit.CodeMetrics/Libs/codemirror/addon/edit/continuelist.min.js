!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(g){"use strict";var m=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,x=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,v=/[*+-]\s/;function I(e,n){var t=n.line,i=0,r=0,l=m.exec(e.getLine(t)),s=l[1];do{var c=t+(i+=1),o=e.getLine(c),a=m.exec(o);if(a){var d=a[1],f=parseInt(l[3],10)+i-r,p=parseInt(a[3],10),u=p;if(s!==d||isNaN(p)){if(s.length>d.length)return;if(s.length<d.length&&1===i)return;r+=1}else f===p&&(u=p+1),p<f&&(u=f+1),e.replaceRange(o.replace(m,d+u+a[4]+a[5]),{line:c,ch:0},{line:c,ch:o.length})}}while(a)}g.commands.newlineAndIndentContinueMarkdownList=function(e){if(e.getOption("disableInput"))return g.Pass;for(var n=e.listSelections(),t=[],i=0;i<n.length;i++){var r=n[i].head,l=e.getStateAfter(r.line),s=!1!==l.list,c=0!==l.quote,o=e.getLine(r.line),a=m.exec(o),d=/^\s*$/.test(o.slice(0,r.ch));if(!n[i].empty()||!s&&!c||!a||d)return void e.execCommand("newlineAndIndent");if(x.test(o))/>\s*$/.test(o)||e.replaceRange("",{line:r.line,ch:0},{line:r.line,ch:r.ch+1}),t[i]="\n";else{var f=a[1],p=a[5],u=!(v.test(a[2])||0<=a[2].indexOf(">")),h=u?parseInt(a[3],10)+1+a[4]:a[2].replace("x"," ");t[i]="\n"+f+h+p,u&&I(e,r)}}e.replaceSelections(t)}});